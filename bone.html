<!DOCTYPE HTML>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pannellum Tour 0–6 (no loops)</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.css"/>
  <link rel="stylesheet" href="css/bone.css">
  <script src="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.js"></script>
</head>

<body>
  <!-- Tombol atas -->
  <div class="top-buttons">
    <a href="index.html" class="back-home">Kembali ke Beranda</a>
    <button class="minimap-btn" onclick="showMinimap()">Tampilkan Minimap</button>
    <button id="toggleDragBtn" class="minimap-btn">Nonaktifkan Drag</button>
    <button id="portalOnlyBtn" class="minimap-btn">Mode Portal Saja</button>
  </div>

  <!-- Modal Minimap -->
  <div id="minimapModal" class="minimap-modal" onclick="hideMinimap()">
    <img src="images/minimap.jpg" alt="Minimap Virtual Tour" class="minimap-img">
  </div>

  <!-- Layout utama -->
  <div class="app">
    <aside id="sidebar">
      <h1>Virtual Tour: Rumah Adat</h1>
      <p class="meta">Jelajahi setiap sudut Rumah Adat. Klik pada titik di panorama untuk berpindah lokasi.</p>
      <div id="sceneGrid" class="grid"></div>
      <div class="controls">
        <button id="prevBtn" title="Scene sebelumnya">◀ Sebelumnya</button>
        <button id="nextBtn" title="Scene berikutnya">Berikutnya ▶</button>
      </div>
    </aside>

    <main id="panorama"></main>
  </div>

  <!-- Overlay panah navigasi tambahan (opsional tampilan overlay, bukan hotspot) -->
  <div class="pano-nav">
    <button class="pano-arrow left" id="arrowLeft">❮</button>
    <button class="pano-arrow right" id="arrowRight">❯</button>
  </div>

  <script>
    // === MODAL MINIMAP ===
    function showMinimap() { document.getElementById('minimapModal').classList.add('active'); }
    function hideMinimap() { document.getElementById('minimapModal').classList.remove('active'); }

    // === SISTEM GRID & TOMBOL SCENE ===
    const START = 0, END = 6;
    const grid = document.getElementById('sceneGrid');
    for (let i = START; i <= END; i++) {
      const b = document.createElement('button');
      b.className = 'scene-btn';
      b.textContent = i;
      b.dataset.scene = 's' + i;
      b.onclick = () => viewer.loadScene('s' + i);
      grid.appendChild(b);
    }

    function setActive() {
      const current = viewer.getScene();
      document.querySelectorAll('.scene-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.scene === current);
      });
    }
    viewer.on('load', setActive);
    setActive();

    // Tombol next / prev di sidebar
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const idxFromScene = sid => parseInt(sid.replace(/^s/, ''), 10);

    prevBtn.onclick = () => {
      const i = idxFromScene(viewer.getScene());
      if (i > START) viewer.loadScene('s' + (i - 1));
    };
    nextBtn.onclick = () => {
      const i = idxFromScene(viewer.getScene());
      if (i < END) viewer.loadScene('s' + (i + 1));
    };

    // === Overlay panah navigasi tambahan (❮ dan ❯) ===
    document.getElementById('arrowLeft').onclick = () => prevBtn.click();
    document.getElementById('arrowRight').onclick = () => nextBtn.click();

    // === Mode Portal Saja ===
    const portalBtn = document.getElementById('portalOnlyBtn');
    let portalOnly = false;
    function setPortalOnly(on) {
      portalOnly = !!on;
      document.querySelectorAll('.scene-btn, #prevBtn, #nextBtn').forEach(el => el.disabled = portalOnly);
      portalBtn.textContent = portalOnly ? 'Mode Portal: AKTIF' : 'Mode Portal Saja';
      portalBtn.style.background = portalOnly ? '#ffb86b' : '';
    }
    portalBtn.onclick = () => setPortalOnly(!portalOnly);
  </script>
</body>
</html>
